[Unit]
Description=Faultlog application

Wants=mapper-wait@-xyz-openbmc_project-inventory.service
After=mapper-wait@-xyz-openbmc_project-inventory.service
Wants=org.open_power.HardwareIsolation.service
After=org.open_power.HardwareIsolation.service
Wants=mapper-wait@-xyz-openbmc_project-logging.service
After=mapper-wait@-xyz-openbmc_project-logging.service
Wants=com.ibm.VPD.Manager.service
After=com.ibm.VPD.Manager.service

Wants=obmc-power-on@%0.target
After=obmc-power-on@%0.target
Conflicts=obmc-power-off@%0.target

[Service]
PIDFile=/run/faultlog.pid
ExecStartPre=/bin/bash -c '/usr/bin/test -e /run/faultlog.pid && /bin/echo "Service already running" && /bin/false || /bin/true'
ExecStart=@bindir@/faultlog -r
ExecStop=/bin/rm -f /run/faultlog.pid
Type=oneshot
SyslogIdentifier=faultlog

[Install]
WantedBy=multi-user.target
